<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/Front-end/styles/recuperar-senha.css">
    <title>Recuperar Senha</title>
</head>
<body>
    <header>
        <a href="/Front-end/pages/book/login.html"><img src="/Front-end/images/logo.svg" alt="" class="logo">  </a>
    </header>
    <div class="right">
        <a href="inicial.html">  <img src="/Front-end/svg/icon-cadeado.svg" alt=""></a>
        <h2>Esqueceu a senha?</h2>
        <p class="a">Insira o e-mail com que se registrou.</p>
        <form id="recoveryForm">
            <label for="email">Email</label>
            <input type="email" id="email" placeholder="Digite seu e-mail" required>
            <button type="submit" id="recoveryButton">Recuperar Senha</button>
        </form>
        <p id="message"></p>
                
    </div>

    <script>
        document.getElementById('recoveryForm').addEventListener('submit', async function (e) {
            e.preventDefault(); 

            const button = document.getElementById('recoveryButton');
            button.disabled = true;
            button.textContent = 'Enviando...';

            const email = document.getElementById('email').value;
            const messageElement = document.getElementById('message');

            try {
                const response = await fetch('http://127.0.0.1:8000/api/send-password-recovery', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email })
                });

                const data = await response.json();

                if (response.ok) {
                    messageElement.textContent = 'E-mail de recuperação enviado com sucesso!';
                    messageElement.style.color = 'green';
                } else {
                    messageElement.textContent = data.message || 'Erro ao enviar e-mail de recuperação.';
                    messageElement.style.color = 'red';
                }

            } catch (error) {
                console.error('Erro no envio do e-mail de recuperação:', error);
                messageElement.textContent = 'Erro inesperado. Tente novamente mais tarde.';
                messageElement.style.color = 'red';
            } finally {
                button.disabled = false;
                button.textContent = 'Recuperar Senha';
            }
        });
    </script>
</body>
</html>
